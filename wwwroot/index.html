<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MarianConsecration</title>

    <!-- Dynamically set the base href based on environment -->
    <base href="/" />

    <!-- Add this script FIRST -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            const savedLang = localStorage.getItem('language') || 'modern';

            document.documentElement.setAttribute('data-theme', savedTheme);
            window.setTheme = (theme) => {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            };

            window.language = savedLang;
        });
    </script>
    <!-- Then your CSS -->
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/app.css" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link href="/MarianConsecration.styles.css" rel="stylesheet" />
    <link href="/manifest.webmanifest" rel="manifest" />
    <link rel="stylesheet" href="/_content/Radzen.Blazor/css/material.css" />
    <link rel="stylesheet" href="/_content/Microsoft.Fast.Components.FluentUI/css/fluent.css" />
</head>
<body>
    <div id="app">
        <!-- Enhanced loading indicator -->
        <div id="loading-overlay">
            <div class="spinner"></div>
            <div class="loading-text">Loading Marian Consecration Assumption 2025</div>
        </div>
    </div>

    <!-- Updated error UI -->
    <div id="blazor-error-ui" class="d-none">
        <div class="alert alert-danger">
            An unhandled error has occurred.
            <a href="" class="reload">Reload</a>
            <span class="dismiss">Ã—</span>
        </div>
    </div>
    <script src="/_content/Microsoft.Fast.Components.FluentUI/js/web-components.min.js"></script>
    <script src="/_content/Radzen.Blazor/js/Radzen.Blazor.js"></script>
    <script src="/_framework/blazor.webassembly.js"></script>
    <script>
        // Error handling
        window.addEventListener('load', function () {
            const errorUi = document.getElementById('blazor-error-ui');
            if (errorUi) {
                errorUi.querySelector('.reload').onclick = function () {
                    location.reload();
                };
                errorUi.querySelector('.dismiss').onclick = function () {
                    errorUi.classList.add('d-none');
                };
            }
        });
    </script>
</body>
</html>
